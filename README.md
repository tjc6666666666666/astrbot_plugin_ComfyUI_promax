# ğŸ¨ Astrbot ComfyUI Plugin Pro Max

[![Version](https://img.shields.io/badge/version-3.3-blue.svg)](https://github.com/tjc6666666666666/astrbot_plugin_ComfyUI_promax)
[![Python](https://img.shields.io/badge/python-3.10%2B-blue.svg)](https://www.python.org/)

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Astrbot æ’ä»¶ï¼Œé›†æˆäº† ComfyUI AI ç»˜ç”»åŠŸèƒ½ï¼Œæ”¯æŒæ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ã€å¤šæœåŠ¡å™¨è½®è¯¢ã€æ¨¡å‹é€‰æ‹©ã€LoRA æ”¯æŒã€è‡ªå®šä¹‰ Workflow ç­‰é«˜çº§åŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸ¯ AI ç»˜ç”»æ ¸å¿ƒåŠŸèƒ½
- **æ–‡ç”Ÿå›¾ (Text-to-Image)**ï¼šé€šè¿‡æ–‡å­—æè¿°ç”Ÿæˆé«˜è´¨é‡å›¾ç‰‡
- **å›¾ç”Ÿå›¾ (Image-to-Image)**ï¼šåŸºäºç°æœ‰å›¾ç‰‡è¿›è¡ŒäºŒæ¬¡åˆ›ä½œ
- **æ‰¹é‡ç”Ÿæˆ**ï¼šæ”¯æŒä¸€æ¬¡ç”Ÿæˆå¤šå¼ å›¾ç‰‡ï¼Œæé«˜æ•ˆç‡
- **å¤šæœåŠ¡å™¨è½®è¯¢**ï¼šæ™ºèƒ½åˆ†é…ä»»åŠ¡åˆ°å¤šä¸ª ComfyUI æœåŠ¡å™¨

### ğŸ› ï¸ é«˜çº§ç‰¹æ€§
- **ğŸ­ æ¨¡å‹é€‰æ‹©**ï¼šæ”¯æŒåˆ‡æ¢ä¸åŒçš„ AI æ¨¡å‹ï¼Œæ»¡è¶³ä¸åŒé£æ ¼éœ€æ±‚
- **âœ¨ LoRA æ”¯æŒ**ï¼šå¯ä½¿ç”¨å¤šä¸ª LoRA æ¨¡å‹å¢å¼ºæ•ˆæœ
- **ğŸ” å›¾ç‰‡åŠ å¯†**ï¼šå¸Œå°”ä¼¯ç‰¹æ›²çº¿å›¾åƒåŠ å¯†ä¿æŠ¤
- **ğŸ’¾ è‡ªåŠ¨ä¿å­˜**ï¼šç”Ÿæˆçš„å›¾ç‰‡è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°
- **ğŸ“¦ å‹ç¼©åŒ…ä¸‹è½½**ï¼šæ”¯æŒæ‰“åŒ…ä¸‹è½½å½“æ—¥ç”Ÿæˆçš„å›¾ç‰‡
- **ğŸ“š æ™ºèƒ½å¸®åŠ©ç³»ç»Ÿ**ï¼šæ”¯æŒæ–‡æœ¬å’Œå›¾ç‰‡å½¢å¼çš„å¸®åŠ©ä¿¡æ¯
- **âš™ï¸ è‡ªå®šä¹‰ Workflow**ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰å·¥ä½œæµï¼Œæ‰©å±•åŠŸèƒ½æ— é™å¯èƒ½

### ğŸ¨ Workflow ç³»ç»Ÿ
- **å›¾åƒåŠ å¯†è§£å¯†**ï¼šå¸Œå°”ä¼¯ç‰¹æ›²çº¿åŠ å¯†/è§£å¯†å·¥ä½œæµ
- **å¯æ‰©å±•æ¶æ„**ï¼šè½»æ¾æ·»åŠ æ–°çš„è‡ªå®šä¹‰å·¥ä½œæµ
- **ç»Ÿä¸€å¸®åŠ©ç³»ç»Ÿ**ï¼šæ¯ä¸ªå·¥ä½œæµéƒ½æœ‰è¯¦ç»†çš„å¸®åŠ©æ–‡æ¡£å’Œå›¾ç‰‡è¯´æ˜
- **å‚æ•°åˆ«åæ”¯æŒ**ï¼šæ”¯æŒä¸­è‹±æ–‡å‚æ•°åï¼Œä½¿ç”¨æ›´ä¾¿æ·
- **é…ç½®æ³¨å…¥åŠŸèƒ½**ï¼šè‡ªåŠ¨åŒæ­¥ä¸»ç¨‹åºçš„æ¨¡å‹ã€LoRAã€é‡‡æ ·å™¨é…ç½®
- **æ™ºèƒ½å‚æ•°éªŒè¯**ï¼šè‡ªåŠ¨éªŒè¯å‚æ•°ç±»å‹ã€èŒƒå›´å’Œå¿…éœ€æ€§
- **ç¼“å­˜æœºåˆ¶**ï¼šå¸®åŠ©å›¾ç‰‡è‡ªåŠ¨ç¼“å­˜ï¼Œæé«˜å“åº”é€Ÿåº¦

## ğŸ“¦ å®‰è£…è¦æ±‚

### Python ä¾èµ–
```bash
pip install -r requirements.txt
```

**requirements.txt å†…å®¹ï¼š**
```txt
aiohttp>=3.8.0
Pillow>=9.0.0
aiofiles>=0.8.0
aiosqlite>=0.17.0
asyncio-throttle>=1.0.0
```

### ComfyUI ç¯å¢ƒè¦æ±‚
- **ComfyUI**: ç¡®ä¿å·²å®‰è£…å¹¶è¿è¡Œ ComfyUI
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **GPU**: æ¨è NVIDIA GPUï¼ˆæ”¯æŒ CUDAï¼‰

### ComfyUI è‡ªå®šä¹‰èŠ‚ç‚¹ï¼ˆå¯é€‰ï¼‰
å¦‚æœéœ€è¦ä½¿ç”¨å›¾ç‰‡åŠ å¯†åŠŸèƒ½ï¼Œéœ€è¦åœ¨ ComfyUI ä¸­å®‰è£…ä»¥ä¸‹è‡ªå®šä¹‰èŠ‚ç‚¹ï¼š

1. **å›¾åƒå‹ç¼©å™¨** (`image_compressor`)
   - ä½œç”¨ï¼šå‹ç¼©å’Œä¼˜åŒ–è¾“å…¥å›¾ç‰‡
   - å®‰è£…ä½ç½®ï¼š`ComfyUI/custom_nodes/image_compressor`

2. **å¸Œå°”ä¼¯ç‰¹å›¾åƒåŠ å¯†** (`hilbert_image_encrypt`)
   - ä½œç”¨ï¼šå¯¹ç”Ÿæˆçš„å›¾ç‰‡è¿›è¡ŒåŠ å¯†ä¿æŠ¤
   - å®‰è£…ä½ç½®ï¼š`ComfyUI/custom_nodes/hilbert_image_encrypt`

> âš ï¸ **é‡è¦æç¤º**ï¼šå¦‚æœå¼€å¯äº†å›¾ç‰‡è§£å¯†åŠŸèƒ½ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œæœç´¢"å°ç•ªèŒ„å›¾ç‰‡æ··æ·†"å·¥å…·è¿›è¡Œè§£å¯†ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ’ä»¶å®‰è£…
å°†æ’ä»¶æ–‡ä»¶æ”¾ç½®åˆ° Astrbot çš„æ’ä»¶ç›®å½•ä¸­ã€‚



### 2. å¯åŠ¨æ’ä»¶
é‡å¯ Astrbotï¼Œæ’ä»¶å°†è‡ªåŠ¨åŠ è½½å¹¶è¿æ¥åˆ° ComfyUI æœåŠ¡å™¨ã€‚

## ğŸ“ ä½¿ç”¨æŒ‡å—

### ğŸ¨ æ–‡ç”Ÿå›¾æŒ‡ä»¤
```
aimg <æç¤ºè¯> [å®½X,é«˜Y] [æ‰¹é‡N] [model:æè¿°] [lora:æè¿°[:å¼ºåº¦][!CLIPå¼ºåº¦]]
```

**ç¤ºä¾‹ï¼š**
```bash
# åŸºç¡€ç”¨æ³•
aimg ç¾å°‘å¥³

# å®Œæ•´å‚æ•°
aimg å¯çˆ±å¥³å­© å®½512,é«˜768 æ‰¹é‡2 model:å†™å®é£æ ¼ lora:å„¿ç«¥:0.8 lora:å¯çˆ±!1.0

# é«˜åˆ†è¾¨ç‡
aimg é£æ™¯ç”» å®½1024,é«˜768 æ‰¹é‡1 model:é£æ™¯é£æ ¼
```

### ğŸ–¼ï¸ å›¾ç”Ÿå›¾æŒ‡ä»¤
```
img2img <æç¤ºè¯> [å™ªå£°:æ•°å€¼] [æ‰¹é‡N] [model:æè¿°] [lora:æè¿°[:å¼ºåº¦][!CLIPå¼ºåº¦]] + å›¾ç‰‡
```

**ç¤ºä¾‹ï¼š**
```bash
# åŸºç¡€å›¾ç”Ÿå›¾
img2img çŒ«å’ª å™ªå£°:0.7

# å®Œæ•´å‚æ•°ï¼ˆéœ€è¦é™„å¸¦å›¾ç‰‡ï¼‰
img2img åŠ¨æ¼«è§’è‰² å™ªå£°:0.5 æ‰¹é‡2 model:åŠ¨æ¼«é£æ ¼ lora:è§’è‰²:1.2!0.9
```

### ğŸ”§ è‡ªå®šä¹‰ Workflow æŒ‡ä»¤
```
<å‰ç¼€> [å‚æ•°å:å€¼ ...] [+ å›¾ç‰‡ï¼ˆå¦‚éœ€è¦ï¼‰]
```

**ç¤ºä¾‹ï¼š**
```bash
# å›¾åƒåŠ å¯†
encrypt æ¨¡å¼:encrypt å¯ç”¨:true + å›¾ç‰‡

# å›¾åƒè§£å¯†
encrypt æ¨¡å¼:decrypt + åŠ å¯†å›¾ç‰‡

# ä½¿ç”¨åˆ«å
encrypt mode:decrypt enable:false + å›¾ç‰‡
```

### ğŸ“¦ å‹ç¼©åŒ…ä¸‹è½½
```
comfyuioutput
```
è·å–ä»Šå¤©ç”Ÿæˆçš„æ‰€æœ‰å›¾ç‰‡çš„å‹ç¼©åŒ…ã€‚

### ğŸ“š å¸®åŠ©ä¿¡æ¯
```bash
aimg          # æ–‡ç”Ÿå›¾å¸®åŠ©
img2img       # å›¾ç”Ÿå›¾å¸®åŠ©
encrypt       # å·¥ä½œæµå¸®åŠ©ï¼ˆç¤ºä¾‹ï¼‰
```

## âš™ï¸ å‚æ•°è¯¦è§£

### ğŸ­ æ¨¡å‹é€‰æ‹©
- **æ ¼å¼**ï¼š`model:æè¿°`
- **ç¤ºä¾‹**ï¼š`model:å†™å®é£æ ¼`
- **è¯´æ˜**ï¼šæè¿°å¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„æ¨¡å‹æè¿°

### âœ¨ LoRA ä½¿ç”¨
- **åŸºç¡€æ ¼å¼**ï¼š`lora:æè¿°`ï¼ˆä½¿ç”¨é»˜è®¤å¼ºåº¦ 1.0/1.0ï¼‰
- **ä»…æ¨¡å‹å¼ºåº¦**ï¼š`lora:æè¿°:0.8`ï¼ˆstrength_model=0.8ï¼‰
- **ä»… CLIP å¼ºåº¦**ï¼š`lora:æè¿°!1.0`ï¼ˆstrength_clip=1.0ï¼‰
- **åŒå¼ºåº¦**ï¼š`lora:æè¿°:0.8!1.3`ï¼ˆmodel=0.8, clip=1.3ï¼‰
- **å¤š LoRA**ï¼šç©ºæ ¼åˆ†éš”å¤šä¸ª lora å‚æ•°

**ç¤ºä¾‹ï¼š**
```bash
lora:å„¿ç«¥ lora:å­¦ç”Ÿ:0.9 lora:å¯çˆ±!1.2
```

### ğŸ“ åˆ†è¾¨ç‡è®¾ç½®
- **æ ¼å¼**ï¼š`å®½X,é«˜Y` æˆ– `å®½,é«˜`
- **ç¤ºä¾‹**ï¼š`å®½512,é«˜768` æˆ– `512,768`
- **é™åˆ¶**ï¼š64~2000 åƒç´ èŒƒå›´

### ğŸ² å…¶ä»–å‚æ•°
- **æ‰¹é‡æ•°**ï¼š`æ‰¹é‡N`ï¼ˆN ä¸ºæ•°é‡ï¼Œæœ€å¤§ 6ï¼‰
- **å™ªå£°ç³»æ•°**ï¼š`å™ªå£°:æ•°å€¼`ï¼ˆ0.0~1.0ï¼Œé»˜è®¤ 0.7ï¼‰
- **ç§å­**ï¼š`ç§å­:æ•°å€¼`ï¼ˆ-1 ä¸ºéšæœºï¼‰

## ğŸ”§ é…ç½®è¯´æ˜

### ğŸŒ æœåŠ¡å™¨é…ç½®
```json
{
  "comfyui_url": ["http://127.0.0.1:8188", "http://192.168.1.100:8188"],
  "max_task_queue": 10,
  "max_failure_count": 3,
  "retry_delay": 300
}
```

### ğŸ¨ æ¨¡å‹é…ç½®
```json
{
  "model_config": [
    {
      "filename": "v1-5-pruned-emaonly.safetensors",
      "description": "å†™å®é£æ ¼"
    },
    {
      "filename": "anime-model.safetensors", 
      "description": "åŠ¨æ¼«é£æ ¼"
    }
  ]
}
```

### âœ¨ LoRA é…ç½®
```json
{
  "lora_config": [
    {
      "filename": "lora1.safetensors",
      "description": "å„¿ç«¥"
    },
    {
      "filename": "lora2.safetensors",
      "description": "å¯çˆ±"
    }
  ]
}
```

### ğŸ• æ—¶é—´é™åˆ¶
```json
{
  "open_time_ranges": "7:00-8:00,11:00-14:00,17:00-24:00"
}
```

## ğŸ”Œ å¯æ‰©å±• Workflow ç³»ç»Ÿ

### ğŸŒŸ åŠŸèƒ½æ¦‚è¿°

æ’ä»¶æ”¯æŒå®Œå…¨å¯æ‰©å±•çš„ Workflow ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ç®€å•çš„é…ç½®æ–‡ä»¶åˆ›å»ºè‡ªå®šä¹‰çš„ ComfyUI å·¥ä½œæµï¼Œæ— éœ€ä¿®æ”¹ä¸»ä»£ç å³å¯æ— é™æ‰©å±•åŠŸèƒ½ã€‚

### ğŸ“ ç›®å½•ç»“æ„
```
workflow/
â”œâ”€â”€ encrypt/
â”‚   â”œâ”€â”€ config.json      # å·¥ä½œæµé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ workflow.json    # ComfyUI å·¥ä½œæµå®šä¹‰
â”‚   â””â”€â”€ help.png         # è‡ªåŠ¨ç”Ÿæˆçš„å¸®åŠ©å›¾ç‰‡
â”œâ”€â”€ juxueli/
â”‚   â”œâ”€â”€ config.json
â”‚   â”œâ”€â”€ workflow.json
â”‚   â””â”€â”€ help.png
â””â”€â”€ your_workflow/
    â”œâ”€â”€ config.json
    â”œâ”€â”€ workflow.json
    â””â”€â”€ help.png
```

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

#### 1. æ¨¡å—åŒ–è®¾è®¡
- **ç‹¬ç«‹æ¨¡å—**ï¼šæ¯ä¸ª workflow éƒ½æ˜¯ç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—
- **çƒ­åŠ è½½**ï¼šé‡å¯æ’ä»¶åè‡ªåŠ¨åŠ è½½æ–°æ¨¡å—
- **é›¶ä»£ç æ‰©å±•**ï¼šé€šè¿‡é…ç½®æ–‡ä»¶å³å¯æ·»åŠ æ–°åŠŸèƒ½

#### 2. çµæ´»çš„å‚æ•°ç³»ç»Ÿ
- **å¤šç§å‚æ•°ç±»å‹**ï¼štextã€numberã€booleanã€selectã€image
- **æ™ºèƒ½éªŒè¯**ï¼šè‡ªåŠ¨éªŒè¯å‚æ•°ç±»å‹ã€èŒƒå›´å’Œå¿…éœ€æ€§
- **åˆ«åæ”¯æŒ**ï¼šæ”¯æŒä¸­è‹±æ–‡å‚æ•°åå’Œè‡ªå®šä¹‰åˆ«å
- **é»˜è®¤å€¼**ï¼šä¸ºæ‰€æœ‰å‚æ•°æä¾›åˆç†çš„é»˜è®¤å€¼

#### 3. é…ç½®æ³¨å…¥åŠŸèƒ½
- **æ¨¡å‹æ³¨å…¥**ï¼šè‡ªåŠ¨åŒæ­¥ä¸»ç¨‹åºçš„æ¨¡å‹é…ç½®
- **LoRA æ³¨å…¥**ï¼šåŠ¨æ€æ˜¾ç¤ºå¯ç”¨çš„ LoRA åˆ—è¡¨
- **é‡‡æ ·å™¨æ³¨å…¥**ï¼šè‡ªåŠ¨ä½¿ç”¨ä¸»ç¨‹åºçš„é‡‡æ ·å™¨é…ç½®
- **è°ƒåº¦å™¨æ³¨å…¥**ï¼šè‡ªåŠ¨åŒæ­¥è°ƒåº¦å™¨è®¾ç½®

#### 4. æ™ºèƒ½å¸®åŠ©ç³»ç»Ÿ
- **è‡ªåŠ¨ç”Ÿæˆå¸®åŠ©**ï¼šæ¯ä¸ª workflow è‡ªåŠ¨ç”Ÿæˆè¯¦ç»†å¸®åŠ©æ–‡æ¡£
- **å›¾ç‰‡å¸®åŠ©**ï¼šæ”¯æŒç²¾ç¾çš„å›¾ç‰‡å½¢å¼å¸®åŠ©ï¼ˆä¸ä¸»å¸®åŠ©æ ·å¼ä¸€è‡´ï¼‰
- **å‚æ•°è¯´æ˜**ï¼šè¯¦ç»†çš„å‚æ•°ç±»å‹ã€èŒƒå›´å’Œç¤ºä¾‹è¯´æ˜
- **ç¼“å­˜æœºåˆ¶**ï¼šå¸®åŠ©å›¾ç‰‡è‡ªåŠ¨ç¼“å­˜ï¼Œæé«˜å“åº”é€Ÿåº¦

### ğŸ“‹ é…ç½®æ–‡ä»¶å®Œæ•´è§„èŒƒ

#### åŸºç¡€ä¿¡æ¯å­—æ®µ
```json
{
  "name": "å·¥ä½œæµæ˜¾ç¤ºåç§°",
  "prefix": "å‘½ä»¤å‰ç¼€",
  "description": "å·¥ä½œæµæè¿°",
  "version": "1.0.0",
  "author": "ä½œè€…",
  "input_mappings": {
    "6": {
      "positive_prompt": {
        "type": "text",
        "required": true,
        "description": "æ­£é¢æç¤ºè¯",
        "aliases": ["prompt", "æç¤ºè¯"]
      }
    }
  },
  "output_mappings": {
    "9": {
      "images": {
        "type": "image",
        "description": "ç”Ÿæˆçš„å›¾ç‰‡"
      }
    }
  },
  "configurable_nodes": [
    {
      "node_id": "6",
      "parameter": "positive_prompt"
    }
  ],
  "node_configs": {
    "6": {
      "width": {
        "type": "number",
        "required": false,
        "default": 512,
        "min": 64,
        "max": 2048,
        "description": "å›¾ç‰‡å®½åº¦",
        "aliases": ["w", "å®½åº¦"]
      },
      "height": {
        "type": "number",
        "required": false,
        "default": 512,
        "min": 64,
        "max": 2048,
        "description": "å›¾ç‰‡é«˜åº¦",
        "aliases": ["h", "é«˜åº¦"]
      },
      "steps": {
        "type": "number",
        "required": false,
        "default": 20,
        "min": 1,
        "max": 150,
        "description": "é‡‡æ ·æ­¥æ•°",
        "aliases": ["æ­¥æ•°"]
      },
      "sampler_name": {
        "type": "select",
        "required": false,
        "default": "euler",
        "options": ["euler", "euler_ancestral", "dpmpp_2m", "dpmpp_sde"],
        "inject_samplers": true,
        "description": "é‡‡æ ·å™¨",
        "aliases": ["sampler", "é‡‡æ ·å™¨"]
      },
      "ckpt_name": {
        "type": "select",
        "required": false,
        "default": "v1-5-pruned-emaonly.safetensors",
        "inject_models": true,
        "description": "æ¨¡å‹",
        "aliases": ["model", "æ¨¡å‹"]
      }
    }
  }
}
```

### ğŸ¨ å‚æ•°ç±»å‹è¯¦è§£

#### 1. æ–‡æœ¬ç±»å‹ (text)
```json
"parameter_name": {
  "type": "text",
  "required": true,
  "description": "å‚æ•°æè¿°",
  "aliases": ["åˆ«å1", "åˆ«å2"]
}
```

#### 2. æ•°å­—ç±»å‹ (number)
```json
"parameter_name": {
  "type": "number",
  "required": false,
  "default": 512,
  "min": 0,
  "max": 1000,
  "description": "å‚æ•°æè¿°",
  "aliases": ["åˆ«å1", "åˆ«å2"]
}
```

#### 3. å¸ƒå°”ç±»å‹ (boolean)
```json
"parameter_name": {
  "type": "boolean",
  "required": false,
  "default": true,
  "description": "å‚æ•°æè¿°",
  "aliases": ["å¼€å¯", "å…³é—­"]
}
```

#### 4. é€‰æ‹©ç±»å‹ (select)
```json
"parameter_name": {
  "type": "select",
  "required": false,
  "default": "option1",
  "options": ["option1", "option2", "option3"],
  "description": "å‚æ•°æè¿°",
  "aliases": ["åˆ«å1", "åˆ«å2"]
}
```

#### 5. å›¾ç‰‡ç±»å‹ (image)
```json
"parameter_name": {
  "type": "image",
  "required": true,
  "description": "å‚æ•°æè¿°",
  "aliases": ["å›¾ç‰‡", "image_input"]
}
```

### ğŸš€ é«˜çº§åŠŸèƒ½

#### é…ç½®æ³¨å…¥åŠŸèƒ½
é€šè¿‡ç‰¹æ®Šæ ‡è®°ï¼Œè®© workflow è‡ªåŠ¨åŒæ­¥ä¸»ç¨‹åºé…ç½®ï¼š

- **`"inject_models": true`**ï¼šè‡ªåŠ¨ä»ä¸»ç¨‹åºçš„ `model_config` åŠ è½½å¯ç”¨æ¨¡å‹
- **`"inject_loras": true`**ï¼šè‡ªåŠ¨æ˜¾ç¤ºå¯ç”¨çš„ LoRA åˆ—è¡¨å’Œæè¿°
- **`"inject_samplers": true`**ï¼šè‡ªåŠ¨ä½¿ç”¨ä¸»ç¨‹åºçš„é»˜è®¤é‡‡æ ·å™¨é…ç½®
- **`"inject_schedulers": true`**ï¼šè‡ªåŠ¨ä½¿ç”¨ä¸»ç¨‹åºçš„é»˜è®¤è°ƒåº¦å™¨é…ç½®

#### åˆ«åç³»ç»Ÿ
æ¯ä¸ªå‚æ•°éƒ½æ”¯æŒå¤šä¸ªåˆ«åï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ä»»ä½•åˆ«åï¼š

```json
{
  "width": {
    "aliases": ["w", "å®½åº¦", "image_width"]
  }
}
```

ç”¨æˆ·è°ƒç”¨æ–¹å¼ï¼š
- `width:800`
- `å®½åº¦:800`
- `w:800`
- `image_width:800`

### ğŸ“š å†…ç½® Workflow ç¤ºä¾‹

#### 1. å›¾åƒåŠ å¯†è§£å¯† (encrypt)
```bash
# åŠ å¯†å›¾ç‰‡
encrypt æ¨¡å¼:encrypt å¯ç”¨:true + å›¾ç‰‡

# è§£å¯†å›¾ç‰‡
encrypt mode:decrypt + åŠ å¯†å›¾ç‰‡

# ä½¿ç”¨åˆ«å
encrypt mode:decrypt enable:false + å›¾ç‰‡
```

#### 2. èšç†æ•ˆæœ (juxueli)
```bash
# åŸºç¡€èšç†æ•ˆæœ
juxueli å¼ºåº¦:0.8 + å›¾ç‰‡

# å®Œæ•´å‚æ•°
juxueli intensity:0.7 mode:enhance + å›¾ç‰‡
```

### ğŸ› ï¸ å¼€å‘æ–° Workflow

#### æ­¥éª¤ 1ï¼šåˆ›å»ºç›®å½•
```bash
mkdir workflow/your_workflow
cd workflow/your_workflow
```

#### æ­¥éª¤ 2ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶ (config.json)
å‚è€ƒä¸Šé¢çš„å®Œæ•´è§„èŒƒåˆ›å»ºé…ç½®æ–‡ä»¶ã€‚

#### æ­¥éª¤ 3ï¼šè·å–å·¥ä½œæµå®šä¹‰
1. åœ¨ ComfyUI ä¸­è®¾è®¡ä½ çš„å·¥ä½œæµ
2. ç‚¹å‡» "Save (API Format)" ä¿å­˜ä¸º workflow.json
3. å°†æ–‡ä»¶æ”¾å…¥ä½ çš„ workflow ç›®å½•

#### æ­¥éª¤ 4ï¼šé‡å¯æ’ä»¶
é‡å¯ Astrbot æ’ä»¶ï¼Œæ–° workflow å°†è‡ªåŠ¨åŠ è½½ã€‚

#### æ­¥éª¤ 5ï¼šæµ‹è¯•åŠŸèƒ½
```bash
your_workflow --help  # æŸ¥çœ‹å¸®åŠ©
your_workflow å‚æ•°:å€¼ + å›¾ç‰‡  # æµ‹è¯•åŠŸèƒ½
```

### ğŸ¯ æœ€ä½³å®è·µ

1. **å‚æ•°è®¾è®¡**ï¼š
   - ä¸ºæ‰€æœ‰å‚æ•°æä¾›åˆç†çš„é»˜è®¤å€¼
   - ä½¿ç”¨æè¿°æ€§çš„å‚æ•°åå’Œåˆ«å
   - è®¾ç½®é€‚å½“çš„å‚æ•°èŒƒå›´é™åˆ¶

2. **é”™è¯¯å¤„ç†**ï¼š
   - æ˜ç¡®æ ‡è®°å¿…éœ€å‚æ•°
   - æä¾›è¯¦ç»†çš„å‚æ•°è¯´æ˜
   - ä½¿ç”¨å‚æ•°éªŒè¯é¿å…é”™è¯¯

3. **ç”¨æˆ·ä½“éªŒ**ï¼š
   - æä¾›ä¸­æ–‡åˆ«å
   - ç¼–å†™æ¸…æ™°çš„æè¿°
   - ä½¿ç”¨ä¸€è‡´çš„å‘½åè§„èŒƒ

4. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - åˆç†ä½¿ç”¨é…ç½®æ³¨å…¥
   - é¿å…ä¸å¿…è¦çš„å‚æ•°
   - ä¼˜åŒ–å·¥ä½œæµç»“æ„

### ğŸ’¾ å­˜å‚¨é…ç½®
```json
{
  "enable_auto_save": true,
  "auto_save_directory": "output",
  "enable_output_zip": true,
  "daily_download_limit": 3,
  "only_own_images": false
}
```

### ğŸ“š å¸®åŠ©ç³»ç»Ÿé…ç½®
```json
{
  "enable_help_image": true,
  "help_server_port": 8080
}
```

## ğŸ”Œ Workflow å¼€å‘

### ğŸ“ ç›®å½•ç»“æ„
```
workflow/
â”œâ”€â”€ encrypt/
â”‚   â”œâ”€â”€ config.json      # å·¥ä½œæµé…ç½®
â”‚   â”œâ”€â”€ workflow.json    # ComfyUI å·¥ä½œæµå®šä¹‰
â”‚   â””â”€â”€ help.png         # è‡ªåŠ¨ç”Ÿæˆçš„å¸®åŠ©å›¾ç‰‡
â””â”€â”€ your_workflow/
    â”œâ”€â”€ config.json
    â”œâ”€â”€ workflow.json
    â””â”€â”€ help.png
```



### ğŸ¯ å‚æ•°ç±»å‹æ”¯æŒ
- **text**: æ–‡æœ¬è¾“å…¥
- **number**: æ•°å€¼è¾“å…¥ï¼ˆæ”¯æŒ min/maxï¼‰
- **select**: ä¸‹æ‹‰é€‰æ‹©
- **boolean**: å¸ƒå°”å€¼
- **image**: å›¾ç‰‡è¾“å…¥

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æ’ä»¶æ— æ³•è¿æ¥åˆ° ComfyUI**
A: æ£€æŸ¥ ComfyUI æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ŒURL é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œé˜²ç«å¢™è®¾ç½®æ˜¯å¦å…è®¸è¿æ¥ã€‚

**Q: ç”Ÿæˆçš„å›¾ç‰‡è´¨é‡ä¸ä½³**
A: å°è¯•è°ƒæ•´æç¤ºè¯ã€æ›´æ¢æ¨¡å‹ã€è°ƒæ•´ CFG å€¼æˆ–ä½¿ç”¨ LoRA å¢å¼ºã€‚

**Q: å¸®åŠ©å›¾ç‰‡æ— æ³•æ˜¾ç¤º**
A: æ£€æŸ¥ `enable_help_image` é…ç½®æ˜¯å¦ä¸º `true`ï¼Œç¡®ä¿æ’ä»¶æœ‰å†™å…¥æƒé™ã€‚

**Q: Workflow æ— æ³•ä½¿ç”¨**
A: æ£€æŸ¥ workflow ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ŒComfyUI æ˜¯å¦æœ‰å¯¹åº”çš„è‡ªå®šä¹‰èŠ‚ç‚¹ã€‚

### æ—¥å¿—æŸ¥çœ‹
æ’ä»¶è¿è¡Œæ—¥å¿—ä¼šè¾“å‡ºåˆ° Astrbot çš„æ—¥å¿—ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹æ—¥å¿—æ¥è¯Šæ–­é—®é¢˜ã€‚

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ğŸš€ æå‡ç”Ÿæˆé€Ÿåº¦
1. **å¤šæœåŠ¡å™¨éƒ¨ç½²**ï¼šé…ç½®å¤šä¸ª ComfyUI æœåŠ¡å™¨å®ç°è´Ÿè½½å‡è¡¡
2. **æ‰¹é‡ç”Ÿæˆ**ï¼šåˆç†è®¾ç½®æ‰¹é‡æ•°ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°
3. **åˆ†è¾¨ç‡ä¼˜åŒ–**ï¼šæ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„åˆ†è¾¨ç‡

### ğŸ’¾ å­˜å‚¨ä¼˜åŒ–
1. **è‡ªåŠ¨æ¸…ç†**ï¼šå®šæœŸæ¸…ç†æ—§çš„ç”Ÿæˆå›¾ç‰‡
2. **å‹ç¼©è®¾ç½®**ï¼šè°ƒæ•´å›¾ç‰‡è´¨é‡å’Œå‹ç¼©æ¯”ä¾‹
3. **åˆ†å¸ƒå¼å­˜å‚¨**ï¼šå°†å­˜å‚¨ç›®å½•é…ç½®åˆ°é«˜é€Ÿç£ç›˜

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼



## ğŸ“„ è®¸å¯è¯




---

<div align="center">



[![Star](https://img.shields.io/github/stars/tjc6666666666666/astrbot_plugin_ComfyUI_promax.svg?style=social&label=Star)](https://github.com/tjc6666666666666/astrbot_plugin_ComfyUI_promax)
[![Fork](https://img.shields.io/github/forks/tjc6666666666666/astrbot_plugin_ComfyUI_promax.svg?style=social&label=Fork)](https://github.com/tjc6666666666666/astrbot_plugin_ComfyUI_promax/fork)

</div>
